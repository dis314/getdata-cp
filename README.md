See comments in script to get more detail on code.
